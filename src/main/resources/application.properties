gg.jte.development-mode=true
spring.application.name=PowerTaskManagerWEB

# Database Configuration (Spring configs are ignored by Quarkus but kept for compatibility)
spring.datasource.url=jdbc:mysql://localhost:3306/powertaskmanager?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
spring.datasource.username=root
spring.datasource.password=00000000
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.hikari.connection-timeout=60000
spring.datasource.hikari.maximum-pool-size=5

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

# Flyway Configuration
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration
spring.flyway.fail-on-missing-locations=false

# Internationalization - Ukrainian only
spring.messages.basename=messages
spring.messages.encoding=UTF-8
spring.messages.cache-duration=3600

# =====================
# Quarkus OIDC security
# =====================
# Use service (bearer-only) mode to validate Bearer tokens issued by OIDC provider
quarkus.oidc.application-type=service
# OIDC discovery URL (Keycloak example by default); can be overridden via env vars
quarkus.oidc.auth-server-url=${OIDC_AUTH_SERVER_URL:http://localhost:8081/realms/quarkus}
# Expected client id / audience
quarkus.oidc.client-id=${OIDC_CLIENT_ID:backend-service}
# Optional audience claim check
quarkus.oidc.token.audience=${OIDC_AUDIENCE:backend-service}

# Secure only the /secure/* endpoints; keep other GET endpoints public (e.g., /hello)
quarkus.http.auth.permission.authenticated.paths=/secure/*
quarkus.http.auth.permission.authenticated.policy=authenticated

# Permit GET requests for all other routes (so existing GET endpoints stay public)
quarkus.http.auth.permission.public.paths=/*
quarkus.http.auth.permission.public.policy=permit
quarkus.http.auth.permission.public.methods=GET

# Disable OIDC tenant during dev and test to avoid requiring a live IdP
%dev.quarkus.oidc.tenant-enabled=false
%test.quarkus.oidc.tenant-enabled=false

# =============================
# Dev-only JWT validation setup
# =============================
# Allow validating HS256 tokens locally without an external IdP
%dev.smallrye.jwt.verify.algorithm=HS256
# 32+ chars dev secret used both for verifying and signing (see /dev/token)
%dev.smallrye.jwt.verify.key=plain:Dp3wNHXkZzU6IGDIo3atYzqVgEIkVk9zN6bf7GUvzPP
%dev.smallrye.jwt.sign.key=plain:Dp3wNHXkZzU6IGDIo3atYzqVgEIkVk9zN6bf7GUvzPP
%dev.smallrye.jwt.new-token.key=plain:Dp3wNHXkZzU6IGDIo3atYzqVgEIkVk9zN6bf7GUvzPP
%dev.smallrye.jwt.new-token.signature-algorithm=HS256
# Expected issuer and audience in the token
%dev.mp.jwt.verify.issuer=http://localhost/dev-issuer
%dev.mp.jwt.verify.audiences=backend-service
